<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"
          "http://www.w3.org/TR/html4/loose.dtd">

<!--#include virtual="/Website/Includes/Config.asp"-->
<!--#include virtual="/Website/Includes/Connection.asp"-->
<!--#include virtual="/Website/pagesTaxRates/LookupZipCode/z2t_userSubscriptions.asp"-->
<!--#include virtual="/Website/pagesTaxRates/LookupZipCode/sql-dev.asp"-->
<%
    Response.buffer = True

    Session("activePage") = "Lookup"
    Session("currentPage") = mid(Request.ServerVariables("URL"), 2, cint(len(Request.ServerVariables("URL"))) - 1) ' Remove preceding /
%>

<html xmlns="http://www.w3.org/1999/xhtml">
<head>
    <title></title>
    
    <script language="javascript" src="map.js" type="text/javascript"></script>
</head>
<body>
    <div>
        <input id="ZipTB" type="text" style="height:20px; width:100px;" value="36426"/><br />
        <textarea id="WktL" style="height:100px; width:600px;"></textarea><br />
        <input id="ConvertBt" type="button" style="height:20px; width:80px;" value="Render"><br />
        </div>
    <div id="map" style="height:800px; width:800px;"></div>
    <script type="text/javascript">
        
        var button = document.getElementById('ConvertBt');
        button.onclick = function () {
            var map;
            var currentPage = '<%=Session("currentPage")%>';
            //var wkt = "POLYGON((-80.190 25.774,-66.118 18.466,-64.757 32.321))";
            var textBox = document.getElementById('ZipTB');


            var zip = textBox.value;//"MULTIPOLYGON (((-107.46744699999999 37.024609, -107.467474 37.023188999999995, -107.466312 37.021363, -107.465076 37.021094, -107.462992 37.017806, -107.461477 37.017002999999995, -107.458796 37.013667, -107.456636 37.011934, -107.456221 37.009744, -107.454199 37.010439999999996, -107.442473 37.01045, -107.44255 37.006802, -107.44219699999901 37.000004853140396, -107.42501599999301 37.0000049716893, -107.425548 37.000149, -107.425203 37.004293, -107.426899 37.004889, -107.427546 37.006516999999995, -107.430495 37.007328, -107.432941 37.009147999999996, -107.432843 37.012634, -107.434425 37.012775, -107.435628 37.016284, -107.43563 37.017711, -107.436527 37.019283, -107.436792 37.021249999999995, -107.43868 37.022462999999995, -107.438767 37.025208, -107.442441 37.025096999999995, -107.442507 37.011823, -107.444258 37.013267, -107.446691 37.017187, -107.448601 37.018747, -107.449994 37.022096, -107.451096 37.022273, -107.452415 37.020103999999996, -107.453712 37.019619999999996, -107.455938 37.020348999999996, -107.458634 37.023775, -107.459872 37.024735, -107.46744699999999 37.024609)), ((-107.4822 37.497822, -107.482131 37.422672999999996, -107.217866 37.422982, -107.219326 37.420995, -107.221138 37.417482, -107.221404 37.415212, -107.220221 37.407181, -107.218659 37.405367999999996, -107.223486 37.402559, -107.225197 37.402228, -107.227432 37.396606999999996, -107.231122 37.391073, -107.230918 37.390145, -107.227149 37.386207, -107.229957 37.385574, -107.232755 37.385619999999996, -107.23307 37.385034999999995, -107.232029 37.378319, -107.23123 37.377393999999995, -107.22725 37.377323, -107.224037 37.376284, -107.222566 37.375017, -107.221957 37.353781999999995, -107.221761 37.351589, -107.222324 37.349998, -107.221422 37.34845, -107.22166 37.342304, -107.221486 37.340264, -107.224844 37.340323, -107.228806 37.339681, -107.232708 37.340662, -107.231268 37.337904, -107.231643 37.334396, -107.229442 37.330486, -107.230479 37.326727, -107.229037 37.32288, -107.228068 37.317879999999995, -107.228818 37.313898, -107.22951499999999 37.312864, -107.227797 37.310763, -107.227023 37.3066, -107.232832 37.304479, -107.239233 37.30046, -107.237825 37.295572, -107.234947 37.290476, -107.233632 37.288787, -107.233841 37.285995, -107.23329 37.283649, -107.231649 37.280801, -107.231506 37.277074999999996, -107.228666 37.274905, -107.228475 37.273194, -107.229218 37.271637999999996, -107.228986 37.26649, -107.228555 37.263788999999996, -107.231103 37.262643, -107.231341 37.258973, -107.228686 37.255671, -107.228437 37.25293, -107.229995 37.250293, -107.231682 37.249021, -107.231372 37.247626, -107.232505 37.246725, -107.232339 37.244583, -107.233086 37.242045, -107.233883 37.241419, -107.233757 37.238040999999996, -107.235267 37.237156, -107.236076 37.234091, -107.242895 37.231803, -107.244638 37.230444999999996, -107.245814 37.231334, -107.247379 37.230454, -107.254818 37.229321, -107.258741 37.227897999999996, -107.258769 37.226653999999996, -107.261345 37.226071999999995, -107.261614 37.225369, -107.264265 37.224871, -107.264994 37.223673999999995, -107.268318 37.223735, -107.27064 37.222621, -107.272913 37.222451, -107.274596 37.221424999999996, -107.277769 37.221607, -107.282955 37.220213, -107.284465 37.221388999999995, -107.28908799999999 37.21966, -107.293895 37.218381, -107.29507 37.216986, -107.295629 37.215007, -107.314494 37.215016, -107.313046 37.214147, -107.313103 37.211819, -107.314074 37.210319, -107.31499 37.206654, -107.317962 37.206765, -107.321462 37.206351, -107.329915 37.203458, -107.336595 37.201613, -107.33653 37.199759, -107.333706 37.196545, -107.335202 37.196228999999995, -107.334131 37.195125, -107.334411 37.192966, -107.333573 37.191648, -107.335216 37.190981, -107.337813 37.194407999999996, -107.337859 37.1958, -107.33663 37.196239, -107.342213 37.203192, -107.342991 37.206215, -107.346181 37.208028999999996, -107.348653 37.213283, -107.348204 37.214998, -107.39895 37.215002999999996, -107.396833 37.214583999999995, -107.395226 37.212686999999995, -107.394231 37.2126, -107.394216 37.210847, -107.395256 37.208939, -107.391635 37.204011, -107.388243 37.202356, -107.382924 37.202262999999995, -107.38086799999999 37.200358, -107.376708 37.198854, -107.37322 37.196466, -107.368388 37.194638999999995, -107.365714 37.191483999999996, -107.363573 37.19159, -107.356715 37.187016, -107.349408 37.183535, -107.340737 37.182369, -107.340028 37.179055, -107.337166 37.176037, -107.338033 37.174478, -107.34465 37.171977, -107.346668 37.16941, -107.347187 37.166942999999996, -107.348476 37.165805999999996, -107.351363 37.164685999999996, -107.355547 37.161853, -107.357698 37.160983, -107.359084 37.159349999999996, -107.359023 37.155203, -107.356748 37.151049, -107.355926 37.147841, -107.35766 37.143333999999996, -107.358863 37.141132999999996, -107.36444 37.141149999999996, -107.364328 37.139402, -107.365613 37.136941, -107.365647 37.135529999999996, -107.363806 37.133913, -107.368538 37.133807, -107.372674 37.131375999999996, -107.374259 37.129594, -107.3773 37.127972, -107.381182 37.122582, -107.38407 37.117157999999996, -107.384744 37.11526, -107.38474 37.109626, -107.388257 37.107428999999996, -107.389614 37.10624, -107.39058299999999 37.104216, -107.392009 37.097333, -107.39377999999999 37.095023999999995, -107.396537 37.089223, -107.398076 37.087627, -107.39889 37.085651999999996, -107.3998 37.081367, -107.400901 37.078964, -107.403193 37.075326, -107.405082 37.075874999999996, -107.405524 37.072832, -107.409095 37.069375, -107.410194 37.067752999999996, -107.414132 37.066271, -107.414805 37.064882, -107.41431 37.062365, -107.414496 37.060862, -107.413442 37.058588, -107.414396 37.054041, -107.415407 37.054131, -107.414497 37.052447, -107.415049 37.04886, -107.416172 37.04623, -107.416652 37.042199, -107.415971 37.039784999999995, -107.414785 37.038087, -107.414203 37.035945, -107.412468 37.032526, -107.409528 37.032821, -107.405937 37.031338999999996, -107.403632 37.028303, -107.404595 37.027736, -107.405461 37.025856, -107.404226 37.026153, -107.404647 37.023925999999996, -107.404382 37.022281, -107.405115 37.018696, -107.404779 37.015639, -107.405089 37.013124, -107.406258 37.009431, -107.408137 37.007881999999995, -107.413487 37.005722999999996, -107.411961 37.007994, -107.413242 37.007261, -107.415561 37.007964, -107.414541 37.006885, -107.414973 37.004549, -107.41705999999999 37.005369, -107.41885 37.005151, -107.41661 37.003788, -107.418826 37.002556, -107.420084 37.003955999999995, -107.419932 37.00221, -107.421831 37.001702, -107.421266 37.000879, -107.422395 37.0000049897742, -107.42091500003501 37.000004999986196, -107.420913 37.000005, -107.25121601031101 37.000046829503695, -107.10911001820601 37.0000818579572, -106.906381919424 37.000131829472693, -106.906326 37.003105999999995, -106.903464 37.004785, -106.897905 37.007318999999995, -106.896058 37.007222999999996, -106.892963 37.008511, -106.889919 37.010619999999996, -106.885594 37.014998999999996, -106.882864 37.016704, -106.877787 37.018752, -106.873406 37.01977, -106.871052 37.020894, -106.86119 37.026727, -106.860296 37.027815, -106.853781 37.031182, -106.851961 37.033125999999996, -106.848347 37.033877, -106.846349 37.035508, -106.843096 37.036701, -106.844349 37.0381, -106.844323 37.039714, -106.841601 37.047731, -106.838703 37.047894, -106.840023 37.049046, -106.837782 37.052631, -106.838207 37.054409, -106.836755 37.056685, -106.833176 37.057947999999996, -106.828051 37.05901, -106.826578 37.060448, -106.823268 37.061706, -106.822033 37.063176999999996, -106.823378 37.066752, -106.823364 37.068041, -106.821069 37.071329999999996, -106.81491199999999 37.075841, -106.811024 37.077414999999995, -106.809589 37.079077, -106.803585 37.081965, -106.799507 37.085291, -106.79836 37.085001, -106.793284 37.085553999999995, -106.791448 37.086504, -106.78872 37.088721, -106.789819 37.091395999999996, -106.78729 37.094004999999996, -106.78643 37.094307, -106.784817 37.096843, -106.769731 37.10688, -106.766716 37.109187, -106.765105 37.109415999999996, -106.764934 37.110746999999996, -106.763614 37.112055, -106.763819 37.113628999999996, -106.762982 37.114895, -106.761836 37.115452, -106.760121 37.114775, -106.756866 37.115643, -106.755636 37.115013, -106.74983399999999 37.117535, -106.748602 37.119443, -106.745163 37.12208, -106.744913 37.123388, -106.700418 37.15298, -106.69771 37.14938, -106.696264 37.150224, -106.696049 37.156718, -106.69447 37.158921, -106.692902 37.162327999999995, -106.686526 37.164006, -106.680082 37.164061, -106.677714 37.164878, -106.67819 37.168852, -106.676626 37.170424, -106.675184 37.173482, -106.674647 37.175689, -106.67651599999999 37.178709, -106.67489 37.179065, -106.671544 37.182086999999996, -106.671406 37.183504, -106.669668 37.184357999999996, -106.666907 37.188911999999995, -106.668275 37.192723, -106.667239 37.193802, -106.66791 37.196118, -106.664323 37.199007, -106.664036 37.201841, -106.662125 37.203058, -106.66007 37.205962, -106.657479 37.208044, -106.656658 37.20966, -106.653353 37.213139999999996, -106.651137 37.21382, -106.648303 37.216108, -106.678354 37.228566, -106.678373 37.403596, -106.710775 37.404227999999996, -106.710875 37.488015, -106.712128 37.485481, -106.712638 37.482506, -106.712581 37.479465, -106.711859 37.478908, -106.713322 37.477565999999996, -106.712121 37.476723, -106.71406999999999 37.475213, -106.716069 37.475218, -106.718726 37.476524, -106.719919 37.476358, -106.719411 37.473326, -106.720538 37.47259, -106.722638 37.472953, -106.722732 37.474824, -106.723463 37.475615, -106.727991 37.476624, -106.729612 37.477536, -106.733933 37.477050999999996, -106.736532 37.477379, -106.739821 37.478871999999996, -106.742399 37.478876, -106.74686 37.480494, -106.749445 37.4809, -106.751338 37.483522, -106.754796 37.486567, -106.756416 37.486815, -106.758676 37.488502, -106.76173 37.488976, -106.76312899999999 37.489855, -106.76195799999999 37.488344, -106.762332 37.485037999999996, -106.764788 37.481034, -106.76492 37.47965, -106.766381 37.479101, -106.768345 37.479596, -106.771365 37.479196, -106.776452 37.477489, -106.777492 37.478335, -106.779739 37.478528, -106.782166 37.476441, -106.783104 37.474788, -106.786426 37.473738999999995, -106.788294 37.475009, -106.791905 37.476085999999995, -106.791491 37.477712, -106.792125 37.478757, -106.79617 37.481956, -106.801099 37.48312, -106.805457 37.483111, -106.807877 37.483416, -106.813764 37.485859999999995, -106.817261 37.488296, -106.820191 37.488093, -106.823422 37.488408, -106.82607899999999 37.487393, -106.83105 37.486379, -106.833679 37.486779999999996, -106.836013 37.486356, -106.838831 37.485257, -106.842467 37.484653, -106.847011 37.481761999999996, -106.85027099999999 37.48065, -106.854552 37.479777999999996, -106.858288 37.477897999999996, -106.857195 37.476873, -106.858942 37.475728, -106.859097 37.474652999999996, -106.861237 37.474331, -106.862773 37.475145, -106.867234 37.474939, -106.868228 37.47441, -106.869463 37.473164, -106.869151 37.47152, -106.872826 37.467017999999996, -106.876658 37.464254, -106.877311 37.462792, -106.87932 37.460859, -106.88119 37.459675, -106.882652 37.45757, -106.883244 37.45574, -106.88283799999999 37.451249, -106.882356 37.450390999999996, -106.87896 37.447899, -106.878519 37.4467, -106.878764 37.44464, -106.877727 37.442992, -106.878029 37.442240999999996, -106.880485 37.44149, -106.887026 37.441978999999996, -106.886388 37.440771, -106.886908 37.438404999999996, -106.885985 37.435567999999996, -106.887645 37.434025999999996, -106.888929 37.431883, -106.890747 37.426904, -106.895096 37.418305, -106.89662 37.413669, -106.898691 37.415315, -106.89907 37.413959999999996, -106.900519 37.412822999999996, -106.900369 37.408384999999996, -106.901716 37.407271, -106.900208 37.406521, -106.897738 37.403988, -106.898367 37.393862999999996, -107.128737 37.392409, -107.12868 37.422942, -107.127818 37.500004, -107.123734 37.625001999999995, -107.123868 37.675028999999995, -107.125605 37.675196, -107.145138 37.675497, -107.140707 37.75, -107.13994 37.757197, -107.139379 37.772783, -107.14106 37.774128, -107.141724 37.772965, -107.143004 37.772548, -107.145012 37.771176, -107.144434 37.769085, -107.146339 37.768446999999995, -107.147916 37.76642, -107.153864 37.762169, -107.157076 37.75897, -107.158667 37.756662, -107.160137 37.75552, -107.161399 37.753411, -107.166249 37.750554, -107.170494 37.745863, -107.175497 37.743894999999995, -107.178319 37.741496, -107.180268 37.74053, -107.187984 37.737195, -107.19341299999999 37.736731, -107.194638 37.736191999999996, -107.197116 37.736095999999996, -107.200451 37.736641, -107.202594 37.735061, -107.204687 37.73467, -107.206347 37.735061, -107.208806 37.734164, -107.213931 37.734345999999995, -107.216196 37.733841999999996, -107.216859 37.732215, -107.220281 37.731626999999996, -107.222253 37.732392999999995, -107.224683 37.731985, -107.226643 37.730076, -107.228545 37.729113, -107.232753 37.728640999999996, -107.235594 37.729285, -107.237133 37.728421999999995, -107.239764 37.728061, -107.240695 37.72643, -107.242681 37.726364, -107.244437 37.725496, -107.248728 37.724885, -107.250843 37.725350999999996, -107.25318 37.724582999999996, -107.255299 37.725046, -107.25768 37.724938, -107.260935 37.72407, -107.262381 37.721827, -107.265212 37.721582999999995, -107.267724 37.720022, -107.270006 37.719133, -107.272751 37.718979999999995, -107.275026 37.717267, -107.282368 37.717141999999996, -107.286059 37.718269, -107.286626 37.719384, -107.288707 37.719988, -107.289156 37.720878, -107.29246 37.722438, -107.299595 37.725426, -107.304345 37.726783, -107.30691 37.72792, -107.314129 37.730193, -107.31845799999999 37.731786, -107.320933 37.733576, -107.32325 37.734404999999995, -107.329253 37.738413, -107.330346 37.739725, -107.333535 37.742124, -107.340541 37.744445, -107.34391600000001 37.743851, -107.34592 37.741603999999995, -107.350269 37.740016, -107.35197 37.740345, -107.355343 37.737614, -107.356773 37.735679999999995, -107.35817 37.735378, -107.35848 37.734362, -107.359863 37.734432, -107.361391 37.733222999999995, -107.362559 37.733152, -107.368151 37.730606, -107.369603 37.73054, -107.371634 37.728809, -107.373729 37.72817, -107.3758 37.726800000000004, -107.376603 37.725536999999996, -107.380096 37.724106, -107.381375 37.724024, -107.384888 37.721801, -107.38614 37.721911, -107.388077 37.719518, -107.391894 37.717898999999996, -107.393837 37.716148, -107.396299 37.715483999999996, -107.39851 37.716259, -107.400398 37.715348, -107.400661 37.713822, -107.403538 37.711011, -107.405377 37.710248, -107.407058 37.707563, -107.407363 37.704674, -107.409996 37.703412, -107.414103 37.700326, -107.416453 37.699602, -107.41713 37.698416, -107.4204 37.696694, -107.42454599999999 37.696033, -107.425956 37.696258, -107.432425 37.694886, -107.43530000000001 37.694765, -107.439881 37.695418, -107.443136 37.694055999999996, -107.446122 37.693507, -107.448679 37.694012, -107.451318 37.693221, -107.45352199999999 37.69204, -107.45478 37.692296999999996, -107.458449 37.690644, -107.460923 37.690104999999996, -107.464019 37.690374, -107.46599499999999 37.689434, -107.46607 37.687715, -107.468598 37.685165999999995, -107.469793 37.684737999999996, -107.473826 37.681200000000004, -107.47415 37.679657, -107.477044 37.678058, -107.478037 37.674904999999995, -107.48057 37.669863, -107.479387 37.667063, -107.482188 37.66769, -107.482179 37.639500999999996, -107.481882 37.500001, -107.4822 37.497822)))";
            var zLen = textBox.value.length
            if (zLen == 5) {
                var URL = '<%=pathBase%>' + currentPage + '?inputZip=' + textBox.value;
                window.document.location = URL;}

            
        };

        function initMap() {


            var myOptions = {
                zoom: 10,
                //center: { lat: 24.886, lng: -70.268 },
                //center: { lat: 31.140486985284188, lng: -87.07403293251069 },
                center: { lat: 37.971991391480209, lng: -89.078767010592458 },

                mapTypeId: 'roadmap'
            };
            map = new google.maps.Map(document.getElementById('map'), myOptions);

            var zip = '<%=Request.QueryString("inputZip") %>';
            if(zip != null && zip.length == 5)
            {
		var textBox = document.getElementById('ZipTB');
		textBox.value = zip;
                <% 
            sqlConnectionString = connStrPublic
                Dim wktSql: wktSql = "SELECT geom.STAsText() as geom, geom.STCentroid().STAsText() as center FROM z2t_ZipBoundariesDemo WHERE geoid10 = '"& Request.QueryString("inputZip") &"'"

            
                Set wktRs = Sql(wktSql)

                If not wktRs.eof then 
                    %>

                var wkt = "<%=wktRs("geom")%>"
                var wktCenter = "<%=wktRs("Center")%>"
                 <%
                  End If
                %>
                var WktL = document.getElementById('WktL');
            
                WktL.value  = wkt;
                RenderBoundaries(wkt,wktCenter);
       
            
            }
        }
        

    </script>
    <script async defer
            src="https://maps.googleapis.com/maps/api/js?key=AIzaSyBDXEyQSh96xRHepefCXiTq7EB4Z3vEpDs&callback=initMap">
    </script>
    <script>
        (function () {
            
        })()
    </script>
    
    
</body>
</html>
